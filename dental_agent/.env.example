# =============================================================================
# Dental AI Voice Agent - Environment Variables
# =============================================================================

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
DATABASE_URL=sqlite:///./dev.db
# For production, use PostgreSQL:
# DATABASE_URL=postgresql://user:password@localhost:5432/dental_agent

# -----------------------------------------------------------------------------
# Redis (for Celery background tasks)
# -----------------------------------------------------------------------------
# Local: redis://localhost:6379/0
# Upstash (free): redis://default:xxx@xxx.upstash.io:6379
REDIS_URL=redis://localhost:6379/0

# -----------------------------------------------------------------------------
# Authentication
# -----------------------------------------------------------------------------
JWT_SECRET=changeme-use-a-secure-random-string
JWT_ALGORITHM=HS256
JWT_EXPIRY_HOURS=24

# -----------------------------------------------------------------------------
# Security Keys
# -----------------------------------------------------------------------------
# Encryption key for database field encryption (Fernet key)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=changeme-generate-fernet-key

# Session secret for cookie/session security
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(50))"
SESSION_SECRET=changeme-use-a-secure-random-string-min-40-chars
SESSION_DURATION_HOURS=24

# -----------------------------------------------------------------------------
# Super Admin Access (Platform Owner Only)
# -----------------------------------------------------------------------------
# Comma-separated list of admin emails who can access /superadmin
SUPER_ADMIN_EMAILS=niyampaneru79@gmail.com

# -----------------------------------------------------------------------------
# Deepgram Configuration
# -----------------------------------------------------------------------------
# Get your API key from https://console.deepgram.com/
DEEPGRAM_API_KEY=your-deepgram-api-key

# -----------------------------------------------------------------------------
# OpenAI Configuration (for Real-time Voice Agent)
# -----------------------------------------------------------------------------
# Get your API key from https://platform.openai.com/api-keys
# Used for: Real-time voice conversations (lowest latency)
OPENAI_API_KEY=your-openai-api-key

# -----------------------------------------------------------------------------
# Google Gemini Configuration (for Analysis - 50% cheaper!)
# -----------------------------------------------------------------------------
# Get your API key from https://aistudio.google.com/apikey
# Used for: Sentiment analysis, call summaries, quality scoring
GEMINI_API_KEY=your-gemini-api-key

# -----------------------------------------------------------------------------
# Hugging Face Configuration (for FREE Embeddings)
# -----------------------------------------------------------------------------
# Get your token from https://huggingface.co/settings/tokens
# Used for: Transcript search, similar call finding, topic clustering
HF_API_KEY=your-huggingface-token

# -----------------------------------------------------------------------------
# Agent Mode
# -----------------------------------------------------------------------------
# SIMULATED = deterministic FSM for testing without API calls
# REAL = actual Deepgram Voice Agent integration
AGENT_MODE=REAL

# -----------------------------------------------------------------------------
# Server URLs
# -----------------------------------------------------------------------------
# API Base URL (for Twilio webhooks)
# In development, use your ngrok HTTPS URL
API_BASE_URL=http://localhost:8000

# WebSocket URL for Twilio Media Streams
# In development, use your ngrok WSS URL
WS_BASE_URL=wss://localhost:8000

# -----------------------------------------------------------------------------
# Telephony Mode
# -----------------------------------------------------------------------------
# SIMULATED = no real calls (for testing)
# TWILIO = real calls via Twilio
TELEPHONY_MODE=TWILIO

# -----------------------------------------------------------------------------
# Twilio Configuration
# -----------------------------------------------------------------------------
# Get these from https://console.twilio.com/
TWILIO_SID=your-twilio-account-sid
TWILIO_TOKEN=your-twilio-auth-token
TWILIO_NUMBER=+19048679643

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_FILE=logs/api.log
LOG_LEVEL=INFO

# =============================================================================
# Development Setup
# =============================================================================
#
# 1. Start ngrok:
#    ngrok http 8000
#    
# 2. Update URLs with ngrok domain:
#    API_BASE_URL=https://abc123.ngrok.io
#    WS_BASE_URL=wss://abc123.ngrok.io
#
# 3. Configure Twilio webhook:
#    - Go to Twilio Console → Phone Numbers → Your Number
#    - Set Voice webhook to: https://your-ngrok-url/inbound/voice
#    - Method: POST
#
# 4. Start the server:
#    uvicorn api_main:app --host 0.0.0.0 --port 8000 --reload
#
# 5. Call your Twilio number to test!
#
# =============================================================================
# MULTI-CLINIC SETUP (Per-Clinic Twilio Numbers)
# =============================================================================
#
# Each clinic gets their own Twilio number for proper routing:
#
# 1. Buy a Twilio number in the clinic's area code ($1-2/month)
#
# 2. Configure that number's webhook with clinic_id param:
#    Webhook URL: https://your-api.com/inbound/voice?clinic_id=CLINIC_ABC
#    Method: POST
#
# 3. The clinic_id can be:
#    - The clinic's database ID
#    - The clinic's name (must match exactly)
#
# 4. Tell the clinic to forward their public number to the Twilio number:
#    - Most carriers: Dial *72 followed by Twilio number
#    - Or set up in their phone system settings
#
# 5. Test: Call the clinic's public number → forwards to Twilio →
#          AI answers with correct clinic greeting
#
# Cost per clinic:
#   - Twilio number: $1-2/month
#   - Call minutes: $0.0085/min inbound + $0.014/min outbound
#   - SMS: $0.0079/msg
#   - Total: ~$50-100/month at 1000 calls
#
# =============================================================================
